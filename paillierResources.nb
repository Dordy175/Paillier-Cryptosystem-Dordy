(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68639,       1473]
NotebookOptionsPosition[     61513,       1350]
NotebookOutlinePosition[     61913,       1366]
CellTagsIndexPosition[     61870,       1363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Paillier Resources", "Text",
 CellChangeTimes->{{3.815121455606593*^9, 
  3.8151214628721657`*^9}},ExpressionUUID->"eea28e68-7768-4a31-bbf4-\
c08e92a80b9b"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "KEYGEN", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8159000673250027`*^9, 3.815900117521485*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ea3a6ab2-9f5d-4817-b308-126de7cb915a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KeyGen", "[", "primeSize_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "output", ",", " ", "p", ",", " ", "q", ",", " ", "n", ",", " ", "n2", 
      ",", " ", "lambda", ",", "g", ",", " ", "mikro", ",", " ", "keyInfo", 
      ",", " ", "publicKey", ",", " ", "privateKey"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"RandomPrime", "[", 
       RowBox[{"{", 
        RowBox[{"100", ",", " ", 
         RowBox[{"10", "^", "primeSize"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", " ", 
      RowBox[{"RandomPrime", "[", 
       RowBox[{"{", 
        RowBox[{"100", ",", " ", 
         RowBox[{"10", "^", "primeSize"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GcdCheck", "[", "]"}], " ", "\[NotEqual]", " ", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", " ", "=", " ", 
         RowBox[{"RandomPrime", "[", 
          RowBox[{"{", 
           RowBox[{"100", ",", " ", 
            RowBox[{"10", "^", "primeSize"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q", "=", " ", 
         RowBox[{"RandomPrime", "[", 
          RowBox[{"{", 
           RowBox[{"100", ",", " ", 
            RowBox[{"10", "^", "primeSize"}]}], "}"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"p", "*", "q"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n2", " ", "=", " ", 
      RowBox[{"n", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "4.", " ", "V\[YAcute]po\[CHacek]et", " ", "Carmichaelovy", " ", "fce", 
       " ", 
       RowBox[{"(", "lambdaG", ")"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lambda", " ", "=", " ", 
      RowBox[{"LCM", "[", 
       RowBox[{
        RowBox[{"p", "-", "1"}], ",", 
        RowBox[{"q", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"GPicker", "[", "n2", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Zde", " ", "s", " ", 
         RowBox[{"p", ".", " ", 
          RowBox[{"Krnavkem", " ", "--"}]}]}], ">", " ", 
        RowBox[{"co", " ", "znamena", " ", "ze", " ", 
         RowBox[{"existuje", "?", " ", "Musi"}], " ", "to", " ", "byt", " ", 
         "Cele", " ", "cislo", " ", "a", " ", "ne", " ", 
         RowBox[{"Realne", "?", " ", "tedy"}], " ", "1", " ", "ok"}]}], ",", 
       " ", 
       RowBox[{"0.1", " ", 
        RowBox[{
        "ko", "  ", "?", "\[IndentingNewLine]", "\[IndentingNewLine]", "Po"}],
         " ", "upresneni", " ", "doplnit", " ", "while", " ", "loop", " ", 
        "s", " ", "overenim", " ", "existence"}], ",", " ", 
       RowBox[{
       "pokud", " ", "neexistuje", " ", "je", " ", "nutne", " ", "zkusit", 
        " ", "jine", " ", "nahodne", " ", "g"}]}], "\[IndentingNewLine]", 
      "    ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mikro", " ", "=", " ", 
      RowBox[{"MMIChecker", "[", 
       RowBox[{"g", ",", " ", "lambda", ",", " ", "n", ",", " ", "n2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Test", " ", "existence", " ", "MMI"}], "  ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegerQ", "[", "mikro", "]"}], " ", "\[Equal]", " ", 
        "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerQ", "[", "mikro", "]"}], " ", "\[Equal]", " ", 
          "False"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"g", " ", "=", " ", 
           RowBox[{"GPicker", "[", "n2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mikro", " ", "=", " ", 
           RowBox[{"MMIChecker", "[", 
            RowBox[{"g", ",", " ", "lambda", ",", " ", "n", ",", " ", "n2"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Public", " ", "Key"}], " ", "=", " ", "n"}], ",", "g"}], 
      "  ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Private", " ", "Key"}], " ", "=", " ", "lamda"}], "  ", 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"keyInfo", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "p", ",", "q", ",", " ", "n", ",", "n2", ",", " ", "lambda", ",", " ", 
        "g", ",", " ", "mikro"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"publicKey", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", "g"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"privateKey", " ", "=", " ", 
      RowBox[{"{", "lambda", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"keyInfo", ",", " ", "publicKey", ",", "privateKey"}], "}"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.815831144015349*^9, 3.8158311696898813`*^9}, {
   3.815831225985321*^9, 3.8158313234010267`*^9}, 3.815831819321838*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"fbfbd107-912d-4eb6-8c4e-d1211e2f2e8c"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\t", "gcdcheck", "\[IndentingNewLine]",
   "*)"}]], "Input",
 CellChangeTimes->{{3.8159001288186345`*^9, 3.8159001333865213`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"90aa47cf-12df-4a37-b189-ef5c94ceceb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GcdCheck", " ", "[", 
   RowBox[{"p_", ",", "q_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", " ", "gcdPQ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"output", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gcdPQ", " ", "=", 
      RowBox[{"GCD", "[", 
       RowBox[{
        RowBox[{"p", "*", "q"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"q", "-", "1"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gcdPQ", " ", "\[Equal]", " ", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"output", " ", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Jedna", " ", "se", " ", "o", " ", "stejna", " ", "prvocisla"}], ",",
          " ", 
         RowBox[{
          RowBox[{"nebo", " ", "jejich", " ", "n"}], "-", 
          "n\[AAcute]sobky"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"output", " ", "=", " ", "0"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"b54be936-7f26-45c0-b7ee-bd09a198d2bc"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\t", 
  RowBox[{"g", ",", " ", 
   RowBox[{"r", " ", "picker"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.815900140257347*^9, 3.815900148537863*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"3d609597-b799-4564-ad2d-25f4d751b974"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GPicker", "[", "n_", "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "g", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"g", ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "g"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RPicker", "[", "n_", "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"r", ";", "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "r"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"26a629b4-929e-44d5-8e14-3872c306b23a"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\t", "MMI", "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8159001549215937`*^9, 3.81590015528961*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"84a8c9e1-eca3-4820-9c96-934a87dde6ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MMIChecker", "[", 
    RowBox[{"g_", ",", " ", "lambda_", ",", " ", "n_", ",", " ", "n2_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"output", ";", "\[IndentingNewLine]", 
      RowBox[{"output", " ", "=", " ", 
       RowBox[{"PowerMod", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               SuperscriptBox["g", "lambda"], ",", 
               RowBox[{"(", 
                RowBox[{"n", "^", "2"}], ")"}]}], " ", "]"}], "-", " ", "1"}],
             "n"], ")"}], ")"}], ",", 
         RowBox[{"-", "1"}], ",", "n"}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "\t", 
   RowBox[{"L", 
    RowBox[{"(", "x", ")"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionL", "[", 
   RowBox[{"x_", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "1"}], ")"}], "/", " ", "n"}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.815900163812251*^9, 3.8159001688265667`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5ccdb1c3-644e-47cd-8f3d-2fb5e5ffd8ab"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
  "Encryption", "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8159001824737687`*^9, 3.815900185194249*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"5432a34b-590e-4ee3-8a69-5f8a7cfd0cff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaillierEncryption", "[", 
   RowBox[{"message_", ",", " ", "primeSize_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "keySetup", ",", "g", ",", "r", ",", "n", ",", "n2", ",", "ciphertext", 
      ",", " ", "gm", " ", ",", " ", "rn", ",", " ", "gmrn", ",", " ", 
      "output", ",", " ", "helper", ",", " ", "helper2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ciphertext", ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", " ", 
      RowBox[{"KeyGen", "[", "primeSize", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "  ", "=", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "  ", "=", " ", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n2", " ", "=", " ", 
      RowBox[{"n", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "  ", "=", 
      RowBox[{"RPicker", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"message", "<", "n"}], " ", "&&", 
        RowBox[{"r", " ", "<", "n"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"g", "^", "message"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rn", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"r", "^", "n"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gmrn", " ", "=", " ", 
         RowBox[{"gm", " ", "*", " ", "rn"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ciphertext", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{"gmrn", ",", 
           RowBox[{"(", 
            RowBox[{"n", "^", "2"}], ")"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", " ", "=", " ", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "All"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ciphertext", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"helper2", ",", "helper"}], " ", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8151296645845337`*^9, 3.815129680968334*^9}, {
  3.815129740937017*^9, 3.8151297487289157`*^9}, {3.815129804649208*^9, 
  3.8151298135366735`*^9}, {3.8151303802668114`*^9, 3.8151304161688995`*^9}, {
  3.8151370118081646`*^9, 3.8151370327123036`*^9}, {3.815831913539509*^9, 
  3.8158319151612015`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"27eac983-7617-4010-b685-8d4c2f6f5cad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", " ", "=", " ", 
  RowBox[{"KeyGen", "[", "3", "]"}]}]], "Input",
 CellChangeTimes->{{3.8151242307451925`*^9, 3.8151242428084397`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e0e75954-8193-4dc8-b9f1-2d7b1f8ce2e4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "223", ",", "431", ",", "96113", ",", "9237708769", ",", "47730", ",", 
     "1316192634", ",", "4436"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"96113", ",", "1316192634"}], "}"}], ",", 
   RowBox[{"{", "47730", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.81512424406287*^9, 3.81512427786051*^9}, {
   3.8151243919546595`*^9, 3.8151243950382733`*^9}, 3.815124456751384*^9, 
   3.8151245885617876`*^9, {3.8151251299231653`*^9, 3.81512518582635*^9}, 
   3.815125910785528*^9, 3.815126443130605*^9, 3.8151272388247037`*^9, 
   3.8151274564955606`*^9, 3.815127553415311*^9, 3.8151276621585107`*^9, 
   3.8151276950186806`*^9, {3.8151277758525333`*^9, 3.81512779846906*^9}, 
   3.8151278720483103`*^9, 3.815128242034806*^9, 3.8151286451702805`*^9, {
   3.8151293351733665`*^9, 3.815129354117362*^9}, {3.815129411318699*^9, 
   3.8151294375239067`*^9}, {3.8151296318985825`*^9, 3.815129685282078*^9}, 
   3.8151297521112647`*^9, 3.8151298165975466`*^9, 3.815130419141672*^9, 
   3.815132689326885*^9, 3.8151331067238355`*^9, 3.8151331933238287`*^9, 
   3.815133227846881*^9, 3.815133260235235*^9, {3.8151336169146566`*^9, 
   3.8151336289331493`*^9}, 3.815133670888962*^9, 3.815133787307975*^9, 
   3.8151338251607933`*^9, 3.8151338907204933`*^9, {3.8151339534172893`*^9, 
   3.8151339800536423`*^9}, 3.815137036558014*^9, 3.8151431027050743`*^9, 
   3.815233961848915*^9, {3.8158310108317466`*^9, 3.8158310199064817`*^9}, 
   3.8158319173702946`*^9, 3.8158344979408307`*^9, 3.8158347113765173`*^9, 
   3.815834822309572*^9, 3.815834862977867*^9, {3.8158349315514045`*^9, 
   3.815834938983713*^9}, 3.8158350425747232`*^9, {3.815835126495783*^9, 
   3.8158351346254253`*^9}, 3.815835247523955*^9, {3.8158353338529015`*^9, 
   3.8158353781301785`*^9}, 3.815835584546972*^9, 3.8158994818174453`*^9, 
   3.8159040774215837`*^9, 3.8163258239355507`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"a189ef88-e452-45ab-bab7-34e9c4fbb8d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8151246874094944`*^9, 3.81512469328112*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4bd3ede7-38c8-4393-98ca-1b6fda06eb65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "223", ",", "431", ",", "96113", ",", "9237708769", ",", "47730", ",", 
   "1316192634", ",", "4436"}], "}"}]], "Output",
 CellChangeTimes->{
  3.815124694296694*^9, 3.8151251299500656`*^9, 3.8151251858664694`*^9, 
   3.8151259108104963`*^9, 3.815126443171524*^9, 3.8151272388666277`*^9, 
   3.8151274565324697`*^9, 3.815127553441208*^9, 3.815127662198406*^9, 
   3.815127695057543*^9, {3.815127775881452*^9, 3.8151277985009394`*^9}, 
   3.815127872082218*^9, 3.81512824207666*^9, 3.8151286451972165`*^9, 
   3.815129411356599*^9, {3.8151296319195957`*^9, 3.815129644253686*^9}, 
   3.815129685307977*^9, 3.8151297521351657`*^9, 3.8151298166194873`*^9, 
   3.815130419173587*^9, 3.815132689363788*^9, 3.815133106770746*^9, 
   3.8151331933657475`*^9, 3.8151332278857813`*^9, 3.815133260270174*^9, {
   3.815133616956574*^9, 3.8151336289770217`*^9}, 3.815133670929859*^9, 
   3.815133787347868*^9, 3.8151338252006884`*^9, 3.815133890765368*^9, {
   3.815133953444216*^9, 3.815133980086582*^9}, 3.8151370365879374`*^9, 
   3.815143102736988*^9, 3.815233961871874*^9, 3.8158310108865995`*^9, 
   3.8158319174101787`*^9, 3.8158344979737473`*^9, 3.815834711412449*^9, 
   3.8158348223504624`*^9, 3.815834863018757*^9, {3.815834931593328*^9, 
   3.8158349390295897`*^9}, 3.8158350426186385`*^9, {3.815835126539695*^9, 
   3.8158351346693153`*^9}, 3.815835247563848*^9, {3.815835333892827*^9, 
   3.815835378180073*^9}, 3.815835584580881*^9, 3.8158994818523197`*^9, 
   3.815904077453498*^9, 3.8163258239624796`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"60604f8f-6cdd-4cd9-9229-0eb9bd32b106"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8151245197136106`*^9, 3.8151245432401433`*^9}, {
  3.81512459377664*^9, 3.81512464094451*^9}, {3.815124677016979*^9, 
  3.8151246974408145`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"5ef547c9-0f17-4b2d-856c-a2ded9fb4fe1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"96113", ",", "1316192634"}], "}"}]], "Output",
 CellChangeTimes->{{3.8151245288602047`*^9, 3.8151245437507753`*^9}, {
   3.815124588584694*^9, 3.815124641810187*^9}, {3.815124678081663*^9, 
   3.8151246979864345`*^9}, 3.8151251299789886`*^9, 3.815125185906396*^9, 
   3.815125910828446*^9, 3.8151264432124205`*^9, 3.815127238903564*^9, 
   3.815127456568334*^9, 3.8151275534568596`*^9, 3.8151276622363367`*^9, 
   3.815127695093482*^9, {3.815127775894387*^9, 3.815127798528864*^9}, 
   3.815127872118123*^9, 3.815128242121541*^9, 3.8151286452241364`*^9, 
   3.815129411387514*^9, {3.8151296319425306`*^9, 3.8151296442886286`*^9}, 
   3.815129685330949*^9, 3.815129752162114*^9, 3.8151298166424255`*^9, 
   3.8151304192005143`*^9, 3.815132689398694*^9, 3.8151331068116293`*^9, 
   3.815133193406608*^9, 3.815133227925641*^9, 3.815133260306046*^9, {
   3.8151336169974675`*^9, 3.815133629017929*^9}, 3.8151336709727397`*^9, 
   3.815133787389784*^9, 3.815133825241579*^9, 3.815133890806264*^9, {
   3.8151339534552193`*^9, 3.8151339800955296`*^9}, 3.8151370366168613`*^9, 
   3.8151431027669086`*^9, 3.815233961892799*^9, 3.815831010931452*^9, 
   3.815831917450081*^9, 3.815834498007657*^9, 3.81583471144736*^9, 
   3.815834822391382*^9, 3.8158348630576844`*^9, {3.8158349316331863`*^9, 
   3.815834939074469*^9}, 3.815835042662516*^9, {3.8158351265815916`*^9, 
   3.815835134711178*^9}, 3.8158352475997524`*^9, {3.815835333930721*^9, 
   3.8158353782299395`*^9}, 3.8158355846128006`*^9, 3.8158994818822794`*^9, 
   3.815904077488425*^9, 3.816325823990404*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"736801e3-49c2-412e-ac3b-f82208944568"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{3.815124704185135*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"ceaff396-b677-48b5-9d10-0d121f7f28e9"],

Cell[BoxData[
 RowBox[{"{", "47730", "}"}]], "Output",
 CellChangeTimes->{
  3.8151247060172796`*^9, 3.81512513001093*^9, 3.8151251859433055`*^9, 
   3.8151259108464*^9, 3.815126443251316*^9, 3.815127238940467*^9, 
   3.815127456605236*^9, 3.8151275534887724`*^9, 3.8151276622732415`*^9, 
   3.8151276951333685`*^9, {3.8151277759243064`*^9, 3.815127798560809*^9}, 
   3.815127872153031*^9, 3.815128242162464*^9, 3.8151286452550583`*^9, 
   3.8151294114197655`*^9, {3.815129631950512*^9, 3.81512964429757*^9}, 
   3.8151296853578763`*^9, 3.8151297521740613`*^9, 3.815129816670354*^9, 
   3.8151304192314315`*^9, 3.815132689433601*^9, 3.815133106853491*^9, 
   3.815133193443508*^9, 3.8151332279645686`*^9, 3.8151332603449416`*^9, {
   3.815133617038353*^9, 3.8151336290608077`*^9}, 3.8151336710156183`*^9, 
   3.8151337874306765`*^9, 3.815133825284463*^9, 3.815133890846157*^9, {
   3.8151339534741683`*^9, 3.8151339801274943`*^9}, 3.8151370366497707`*^9, 
   3.815143102797826*^9, 3.8152339619157715`*^9, 3.8158310109763327`*^9, 
   3.815831917487981*^9, 3.815834498039567*^9, 3.8158347114812374`*^9, 
   3.815834822432271*^9, 3.8158348630968547`*^9, {3.8158349316730795`*^9, 
   3.8158349391183205`*^9}, 3.815835042707368*^9, {3.815835126622488*^9, 
   3.815835134754091*^9}, 3.815835247635684*^9, {3.8158353339691076`*^9, 
   3.8158353782798147`*^9}, 3.8158355846467075`*^9, 3.81589948191216*^9, 
   3.815904077528349*^9, 3.8163258240153694`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"57e33d09-41ad-407f-b493-74587d3337aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.815124720520286*^9, 3.8151247211277018`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"b502d9e3-afd8-4332-831b-3ef4c2b9b7e6"],

Cell[BoxData["223"], "Output",
 CellChangeTimes->{
  3.815124722228732*^9, 3.81512513004285*^9, 3.8151251859558268`*^9, 
   3.81512591086332*^9, 3.815126443289217*^9, 3.8151272389544373`*^9, 
   3.8151274566391726`*^9, 3.815127553524677*^9, 3.815127662309142*^9, 
   3.815127695169277*^9, {3.8151277759572496`*^9, 3.8151277985897026`*^9}, 
   3.815127872185948*^9, 3.8151282421754293`*^9, 3.815128645283976*^9, 
   3.8151294114506845`*^9, {3.8151296319764447`*^9, 3.81512964432749*^9}, 
   3.8151296853837748`*^9, 3.8151297522050133`*^9, 3.8151298166962833`*^9, 
   3.8151304192633467`*^9, 3.8151326894665203`*^9, 3.8151331068934155`*^9, 
   3.8151331934814262`*^9, 3.8151332280024643`*^9, 3.8151332603798776`*^9, {
   3.81513361707825*^9, 3.8151336291017013`*^9}, 3.815133671056506*^9, 
   3.81513378747057*^9, 3.8151338253283453`*^9, 3.81513389088804*^9, {
   3.8151339534841423`*^9, 3.8151339801553955`*^9}, 3.8151370366856723`*^9, 
   3.8151431028287435`*^9, 3.815233961939707*^9, 3.815831011019248*^9, 
   3.81583191752488*^9, 3.8158344980704846`*^9, 3.815834711517174*^9, 
   3.815834822474165*^9, 3.8158348631357574`*^9, {3.815834931717984*^9, 
   3.815834939163231*^9}, 3.8158350427506695`*^9, {3.8158351266655855`*^9, 
   3.8158351347989693`*^9}, 3.8158352476695967`*^9, {3.815835334007002*^9, 
   3.81583537832968*^9}, 3.815835584681673*^9, 3.815899481943077*^9, 
   3.81590407754132*^9, 3.816325824039273*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"cbeca9d7-a365-44bd-9523-6bae99b94609"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"key", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"-", "1"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.8151247295123763`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"96670198-4699-4ae3-8f72-e1e647b1553d"],

Cell[BoxData["4436"], "Output",
 CellChangeTimes->{
  3.815124730933528*^9, 3.815125130074767*^9, 3.8151251860027323`*^9, 
   3.815125910874319*^9, 3.8151264433275003`*^9, 3.815127238993351*^9, 
   3.815127456673088*^9, 3.8151275535571647`*^9, 3.815127662345045*^9, 
   3.815127695205177*^9, {3.8151277759702187`*^9, 3.815127798620647*^9}, 
   3.815127872217856*^9, 3.815128242217314*^9, 3.8151286453148937`*^9, 
   3.8151294114825993`*^9, {3.8151296319854183`*^9, 3.8151296443584433`*^9}, 
   3.8151296854136944`*^9, 3.815129752233676*^9, 3.815129816706222*^9, 
   3.815130419297256*^9, 3.8151326895024242`*^9, 3.815133106936268*^9, 
   3.8151331935183277`*^9, 3.8151332280423293`*^9, 3.81513326041578*^9, {
   3.815133617117136*^9, 3.8151336291425586`*^9}, 3.815133671097396*^9, 
   3.815133787510463*^9, 3.815133825370228*^9, 3.8151338909279394`*^9, {
   3.8151339535040903`*^9, 3.815133980183323*^9}, 3.815137036719587*^9, 
   3.815143102859661*^9, 3.81523396196264*^9, 3.815831011065123*^9, 
   3.8158319175617867`*^9, 3.815834498103401*^9, 3.815834711553079*^9, 
   3.81583482251306*^9, 3.8158348631736507`*^9, {3.815834931764864*^9, 
   3.8158349392081113`*^9}, 3.815835042796542*^9, {3.8158351267084713`*^9, 
   3.81583513484286*^9}, 3.815835247703503*^9, {3.8158353340449038`*^9, 
   3.815835378380539*^9}, 3.815835584714656*^9, 3.8158994819750247`*^9, 
   3.8159040775806108`*^9, 3.8163258240662336`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"8ec93cfc-d995-45fc-87c6-a1c5ea73bf51"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8151252015534487`*^9, 3.815125204816608*^9}, 
   3.815127449528614*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"f4502852-3673-4c55-9226-f3916131f618"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ciphertest", "=", " ", 
  RowBox[{"PaillierEncryption", "[", 
   RowBox[{"10", ",", " ", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8151250894003277`*^9, 3.8151251207205925`*^9}, {
  3.8151252536173697`*^9, 3.815125271488124*^9}, {3.8151278494816217`*^9, 
  3.815127849880576*^9}, {3.8151282338965664`*^9, 3.8151282340401497`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f5f2faf7-42bc-4d46-b7f5-f927c9596d28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"167245639034", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "929", ",", "577", ",", "536033", ",", "287331377089", ",", "16704", ",", 
     "15180945345", ",", "36046"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8151251081258464`*^9, 3.815125207356146*^9}, {
   3.815125259610198*^9, 3.8151252728574624`*^9}, 3.8151259109032393`*^9, 
   3.8151264433763676`*^9, 3.8151272391369743`*^9, {3.815127444419592*^9, 
   3.815127456719929*^9}, 3.8151275536010513`*^9, 3.8151276624796534`*^9, 
   3.815127695269006*^9, {3.8151277760190816`*^9, 3.815127798676498*^9}, 
   3.8151278722786956`*^9, {3.815128235984949*^9, 3.8151282422671824`*^9}, 
   3.8151286453577805`*^9, {3.815129304121739*^9, 3.815129358076329*^9}, {
   3.815129411526721*^9, 3.8151294406389694`*^9}, {3.815129632069767*^9, 
   3.8151296443970757`*^9}, {3.815129685476557*^9, 3.81512976269628*^9}, {
   3.8151298167431602`*^9, 3.8151298270794444`*^9}, 3.815130419343133*^9, 
   3.815132689576229*^9, 3.8151331070031176`*^9, 3.8151331935961323`*^9, 
   3.8151332281350822`*^9, 3.8151332605164833`*^9, {3.8151336171779847`*^9, 
   3.8151336292173586`*^9}, 3.815133671154225*^9, 3.815133787567319*^9, 
   3.8151338254290433`*^9, 3.8151338909827895`*^9, {3.8151339535729046`*^9, 
   3.815133980216237*^9}, 3.815137036765464*^9, 3.8151431029035435`*^9, 
   3.8152339621421576`*^9, 3.81583101114392*^9, 3.815831917614641*^9, 
   3.815834498149246*^9, 3.8158347116378465`*^9, 3.8158348225669127`*^9, 
   3.8158348632409935`*^9, {3.8158349318217096`*^9, 3.8158349392759256`*^9}, 
   3.815835042852392*^9, {3.815835126764425*^9, 3.815835134905759*^9}, 
   3.815835247794425*^9, {3.815835334112787*^9, 3.815835378464319*^9}, 
   3.8158355847628965`*^9, 3.8158994820468345`*^9, 3.815904077649399*^9, 
   3.8163258243983364`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"2ee56561-7876-4453-8b42-aed4e24d5ec6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ciphertest"], "Input",
 CellChangeTimes->{{3.815126425384036*^9, 3.8151264460089426`*^9}, {
   3.815127474009141*^9, 3.815127505752034*^9}, 3.815127731656726*^9, {
   3.815127852896519*^9, 3.8151278533044004`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"6d1aacd5-2fd2-426e-83a4-f9323e700c9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"167245639034", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "929", ",", "577", ",", "536033", ",", "287331377089", ",", "16704", ",", 
     "15180945345", ",", "36046"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.815126432040584*^9, 3.8151264464595613`*^9}, 
   3.8151272391739063`*^9, {3.8151274567518764`*^9, 3.8151275065623765`*^9}, 
   3.8151275536319656`*^9, 3.8151276625165834`*^9, 3.8151276953059072`*^9, 
   3.8151277321134987`*^9, {3.815127776061939*^9, 3.8151277987104073`*^9}, 
   3.8151278723165636`*^9, 3.815128242306075*^9, 3.815128645390691*^9, 
   3.8151294115606594`*^9, {3.8151296320986605`*^9, 3.8151296444250035`*^9}, 
   3.815129685506479*^9, 3.815129752312496*^9, 3.815129816773068*^9, 
   3.815130419379037*^9, 3.815132689609112*^9, 3.8151331070460105`*^9, 
   3.815133193634034*^9, 3.8151332281749744`*^9, 3.815133260552417*^9, {
   3.81513361722087*^9, 3.815133629263268*^9}, 3.8151336711981354`*^9, 
   3.815133787610203*^9, 3.815133825471961*^9, 3.81513389102568*^9, {
   3.8151339535958104`*^9, 3.815133980244166*^9}, 3.815137036798372*^9, 
   3.8151431029304714`*^9, 3.81523396216507*^9, 3.8158310111778135`*^9, 
   3.815831917655534*^9, 3.815834498181163*^9, 3.8158347116717267`*^9, 
   3.8158348226078024`*^9, 3.815834863278984*^9, {3.8158349318596153`*^9, 
   3.815834939321802*^9}, 3.8158350428982725`*^9, {3.8158351268083067`*^9, 
   3.8158351349516635`*^9}, 3.8158352478313274`*^9, {3.815835334151656*^9, 
   3.815835378513156*^9}, 3.815835584797803*^9, 3.8158994820747595`*^9, 
   3.8159040776808343`*^9, 3.8163258244222827`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"90ae1892-9b9e-46d4-9e5d-d506775c4fd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ciphertest", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.815127466400491*^9, 3.8151274703200197`*^9}, {
  3.8151275629042406`*^9, 3.8151275980646687`*^9}, {3.815127665080731*^9, 
  3.81512770975326*^9}, {3.815127806872588*^9, 3.8151278137202673`*^9}, {
  3.8151278572808046`*^9, 3.8151278577275743`*^9}, {3.815128555576663*^9, 
  3.815128573097785*^9}, {3.8151286102486286`*^9, 3.8151286217838182`*^9}, {
  3.815128655056816*^9, 3.815128663200076*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"2ebce9fd-efc1-43b9-bff3-9ddbe5c82bbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"167245639034", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.815127594048039*^9, 3.815127599394272*^9}, {
   3.8151276625634613`*^9, 3.8151277160803623`*^9}, {3.8151277760938807`*^9, 
   3.815127814952981*^9}, 3.815127872328561*^9, 3.8151282423449764`*^9, {
   3.8151285581039143`*^9, 3.81512857344489*^9}, {3.815128611327776*^9, 
   3.8151286147356663`*^9}, {3.8151286454226103`*^9, 3.815128663516226*^9}, 
   3.815129411594572*^9, {3.8151296321076365`*^9, 3.8151296444359713`*^9}, 
   3.815129685517446*^9, 3.815129752343708*^9, 3.815129816783017*^9, 
   3.8151304193929996`*^9, 3.8151326896460457`*^9, 3.8151331070898857`*^9, 
   3.8151331936728964`*^9, 3.8151332282158947`*^9, 3.815133260589321*^9, {
   3.8151336172637243`*^9, 3.815133629310113*^9}, 3.8151336712380023`*^9, 
   3.8151337876540794`*^9, 3.8151338255158405`*^9, 3.8151338910675325`*^9, {
   3.8151339536177845`*^9, 3.8151339802720594`*^9}, 3.815137036830286*^9, 
   3.815143102958397*^9, 3.815233962185017*^9, 3.8158310112157135`*^9, 
   3.8158319176944313`*^9, 3.8158344982130747`*^9, 3.8158347117056694`*^9, 
   3.8158348226466713`*^9, 3.8158348633179083`*^9, {3.815834931898511*^9, 
   3.8158349393666897`*^9}, 3.81583504294415*^9, {3.815835126851194*^9, 
   3.815835134994549*^9}, 3.815835247869253*^9, {3.8158353341885853`*^9, 
   3.8158353785590596`*^9}, 3.815835584833*^9, 3.815899482104662*^9, 
   3.815904077710755*^9, 3.8163258244482136`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"e1617fcf-f7ce-4cf3-b6d3-523558bf313b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ciphertest", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8151278195526495`*^9, 3.815127820071263*^9}, {
  3.8151278667763777`*^9, 3.81512786716833*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f79aa4d0-43dc-4378-afc1-57e3126a1334"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "929", ",", "577", ",", "536033", ",", "287331377089", ",", "16704", ",", 
   "15180945345", ",", "36046"}], "}"}]], "Output",
 CellChangeTimes->{
  3.815127820886117*^9, 3.8151278723674603`*^9, 3.815128242382842*^9, 
   3.815128645441526*^9, 3.8151294116274853`*^9, {3.815129632138587*^9, 
   3.815129644464897*^9}, 3.8151296855474215`*^9, 3.8151297523736286`*^9, 
   3.815129816813961*^9, 3.815130419425912*^9, 3.8151326896819487`*^9, 
   3.815133107132742*^9, 3.815133193710826*^9, 3.8151332282537646`*^9, 
   3.815133260624227*^9, {3.8151336173056383`*^9, 3.815133629352997*^9}, 
   3.815133671278927*^9, 3.815133787694969*^9, 3.815133825556735*^9, 
   3.8151338911094484`*^9, {3.8151339536267614`*^9, 3.8151339802830286`*^9}, 
   3.8151370368612037`*^9, 3.815143102986322*^9, 3.8152339622069635`*^9, 
   3.8158310112276893`*^9, 3.8158319177322993`*^9, 3.8158344982455606`*^9, 
   3.8158347117425656`*^9, 3.815834822684596*^9, 3.815834863356809*^9, {
   3.8158349319354057`*^9, 3.8158349394125595`*^9}, 3.81583504298604*^9, {
   3.8158351268961086`*^9, 3.815835135038434*^9}, 3.8158352479051294`*^9, {
   3.815835334226488*^9, 3.815835378606164*^9}, 3.8158355848684196`*^9, 
   3.8158994821325693`*^9, 3.8159040777416725`*^9, 3.8163258244721155`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"3d37ec45-7443-4d06-af86-66557af9facf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ciphertest", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.815127825336185*^9, 3.8151278266885686`*^9}, {
  3.815127868913663*^9, 3.815127869319577*^9}, {3.815130435105077*^9, 
  3.815130443920393*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"210fe982-e9e2-4903-bb14-a8adefa0cf12"],

Cell[BoxData["167245639034"], "Output",
 CellChangeTimes->{
  3.8151278278285666`*^9, 3.815127872405328*^9, 3.8151282424217663`*^9, 
   3.815128645454524*^9, 3.8151294116603975`*^9, {3.8151296321674767`*^9, 
   3.8151296444967585`*^9}, 3.8151296855773306`*^9, 3.8151297524045486`*^9, 
   3.8151298168448772`*^9, {3.8151304194388776`*^9, 3.81513044426846*^9}, 
   3.8151326897158546`*^9, 3.8151331071756277`*^9, 3.815133193745737*^9, 
   3.8151332282906666`*^9, 3.815133260661124*^9, {3.8151336173445425`*^9, 
   3.8151336293949184`*^9}, 3.8151336713198147`*^9, 3.815133787734863*^9, 
   3.8151338255966277`*^9, 3.815133891150342*^9, {3.815133953646674*^9, 
   3.8151339803109818`*^9}, 3.8151370368920927`*^9, 3.815143103012252*^9, 
   3.815233962220948*^9, 3.8158310112665777`*^9, 3.815831917769231*^9, 
   3.8158344982764826`*^9, 3.815834711776618*^9, 3.8158348227235007`*^9, 
   3.8158348633927774`*^9, {3.8158349319713106`*^9, 3.815834939460432*^9}, 
   3.8158350430299187`*^9, {3.8158351269379954`*^9, 3.8158351350803213`*^9}, 
   3.81583524794007*^9, {3.815835334262393*^9, 3.8158353786510105`*^9}, 
   3.8158355849033604`*^9, 3.815899482161845*^9, 3.8159040777786055`*^9, 
   3.816325824497085*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"8bcf1e73-27db-44c9-81d2-8e465498fe55"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "DECRYPT", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8159001941777687`*^9, 3.8159001972333946`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"3b62bda3-9f90-4f11-922c-2fb7842dd92d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaillierDecryption", "[", 
   RowBox[{
   "ciphertext_", ",", " ", "lambda_", ",", " ", "n_", ",", " ", "mikro_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"outputDec", ",", "opentext", ",", " ", "inputL"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDec", " ", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"inputL", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"opentext", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"opentext", " ", "=", " ", 
      RowBox[{"Mod", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"FunctionL", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"ciphertext", "^", "lambda"}], ",", " ", 
             RowBox[{"n", "^", "2"}]}], "]"}], " ", ",", "n"}], "]"}], "*", 
         " ", "mikro"}], ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "opentext"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8151322434085307`*^9, 3.815132328079732*^9}, {
   3.8151323800718384`*^9, 3.815132383959443*^9}, {3.8151324236070824`*^9, 
   3.815132425175915*^9}, {3.815132460687954*^9, 3.8151325066078725`*^9}, {
   3.8151325600001316`*^9, 3.8151325790313487`*^9}, {3.8151326780560274`*^9, 
   3.81513268112779*^9}, {3.8151330619366255`*^9, 3.815133097544381*^9}, {
   3.8151331682802343`*^9, 3.8151331869039946`*^9}, {3.81513322176814*^9, 
   3.8151332555198436`*^9}, {3.8151336125762787`*^9, 
   3.8151336248560524`*^9}, {3.8151336620246363`*^9, 
   3.8151336674232006`*^9}, {3.815133723128251*^9, 3.8151337837515182`*^9}, {
   3.8151338174803324`*^9, 3.815133887711507*^9}, {3.815133969432043*^9, 
   3.815133977104554*^9}, 3.815837038880661*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"5673865d-7d98-459d-8196-c21cacb7f3c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"petrklicek", " ", "=", " ", 
  RowBox[{"PaillierDecryption", "[", 
   RowBox[{"266349694870", ",", "293724", " ", ",", "588983", ",", "410987"}],
    " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.8151333287533493`*^9, 3.8151333997358212`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c5712c7e-a685-4e33-a14d-277d9aa015de"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{
  3.815133402174264*^9, {3.8151336175539474`*^9, 3.8151336296622057`*^9}, 
   3.8151336715312166`*^9, 3.815133746073267*^9, {3.815133788100889*^9, 
   3.815133825935689*^9}, 3.8151338914784355`*^9, {3.8151339537045207`*^9, 
   3.815133980430662*^9}, 3.815137037005788*^9, 3.81514310315242*^9, 
   3.815233962327671*^9, 3.8158310113922524`*^9, 3.8158319178729496`*^9, 
   3.8158344983762107`*^9, 3.815834711879373*^9, 3.815834822827216*^9, 
   3.815834863499559*^9, {3.8158349320750046`*^9, 3.8158349395701103`*^9}, 
   3.8158350431405945`*^9, {3.8158351270457053`*^9, 3.815835135190034*^9}, 
   3.815835248040801*^9, {3.815835334366082*^9, 3.8158353787667007`*^9}, 
   3.8158355850060835`*^9, 3.8158994822277007`*^9, 3.815904077863382*^9, 
   3.8163258245698547`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"985a4b84-e31d-4468-b302-d9d60cf57119"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mod", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"FunctionL", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"266349694870", "^", "293724"}], ",", " ", 
        RowBox[{"588983", "^", "2"}]}], "]"}], " ", ",", "588983"}], "]"}], 
    "*", " ", "410987"}], ",", " ", "588983"}], "]"}]], "Input",
 CellChangeTimes->{{3.8151335311932817`*^9, 3.815133580775689*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"5e27b5eb-dab1-4ac7-8eb0-faf68e75a1c0"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{
  3.815133582649706*^9, {3.8151336175968647`*^9, 3.8151336297070503`*^9}, 
   3.8151336715731373`*^9, 3.815133788141778*^9, 3.8151338259786067`*^9, 
   3.815133891520322*^9, {3.8151339537464085`*^9, 3.815133980467536*^9}, 
   3.8151370370616393`*^9, 3.8151431031913157`*^9, 3.8152339623685255`*^9, 
   3.8158310114321136`*^9, 3.8158319179108505`*^9, 3.8158344984161043`*^9, 
   3.8158347119182386`*^9, 3.815834822867081*^9, 3.8158348635375347`*^9, {
   3.815834932112908*^9, 3.815834939614025*^9}, 3.8158350431845093`*^9, {
   3.8158351270885906`*^9, 3.815835135233882*^9}, 3.8158352480786657`*^9, {
   3.8158353344050055`*^9, 3.81583537881557*^9}, 3.815835585045972*^9, 
   3.815899482272581*^9, 3.8159040779132166`*^9, 3.8163258246097836`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"29e10655-6fd4-411c-9a52-fb729846a061"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "ADDITION",
   "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.815900201913411*^9, 3.815900205161298*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ec8498ec-212d-4000-8ac5-e8fe5a62fa13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"message_", ",", "message2_", ",", " ", "primeSize_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "keySetup", ",", "g", ",", "r1", ",", "r2", ",", "n", ",", "n2", ",", 
      "ciphertext", ",", "ciphertext2", ",", " ", "gm", " ", ",", " ", "rn", 
      ",", " ", "gmrn", ",", " ", "output", ",", " ", "helper", ",", " ", 
      "helper2", ",", "r", ",", "test"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ciphertext", ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", " ", 
      RowBox[{"KeyGen", "[", "primeSize", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "  ", "=", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "  ", "=", " ", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n2", " ", "=", " ", 
      RowBox[{"n", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "  ", "=", 
      RowBox[{"RPicker", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2", "  ", "=", 
      RowBox[{"RPicker", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"message", "<", "n"}], " ", "&&", 
        RowBox[{"r1", " ", "<", "n"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"g", "^", "message"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rn", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"r1", "^", "n"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gmrn", " ", "=", " ", 
         RowBox[{"gm", " ", "*", " ", "rn"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ciphertext", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{"gmrn", ",", 
           RowBox[{"(", 
            RowBox[{"n", "^", "2"}], ")"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"message2", "<", "n"}], " ", "&&", 
        RowBox[{"r2", " ", "<", "n"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"g", "^", "message2"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rn", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"r2", "^", "n"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gmrn", " ", "=", " ", 
         RowBox[{"gm", " ", "*", " ", "rn"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ciphertext2", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{"gmrn", ",", 
           RowBox[{"(", 
            RowBox[{"n", "^", "2"}], ")"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"PaillierDecryption", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"PowerMod", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ciphertext", "*", "ciphertext2"}], ")"}], ",", "1", ",", 
           "n2"}], "]"}], ")"}], ",", 
        RowBox[{"keySetup", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "5"}], "]"}], "]"}], ",", "n", " ", ",", 
        RowBox[{"keySetup", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"test", " ", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"message", "+", "message2"}], ")"}], ",", " ", "n"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ciphertext", ",", "ciphertext2", ",", "r", ",", "test"}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"r", "=", "test"}], ";", "\[IndentingNewLine]", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", "helper"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.815832738740754*^9, 3.815832779977064*^9}, {
   3.815833897385109*^9, 3.8158339683214025`*^9}, {3.8158339984738626`*^9, 
   3.8158340125847073`*^9}, 3.815834079393171*^9, {3.815834158305501*^9, 
   3.8158341822494698`*^9}, {3.815834212569372*^9, 3.815834262552271*^9}, 
   3.815834304424797*^9, {3.8158343862171555`*^9, 3.81583439237691*^9}, {
   3.8158344352023106`*^9, 3.8158344365138044`*^9}, {3.815834475968407*^9, 
   3.8158344934736*^9}, {3.8158345564659185`*^9, 3.815834557281737*^9}, {
   3.81583463774505*^9, 3.815834703351011*^9}, {3.815834807129651*^9, 
   3.815834817584239*^9}, {3.8158348570895367`*^9, 3.8158348583531575`*^9}, {
   3.8158351213300734`*^9, 3.8158351316812787`*^9}, {3.8158352204822865`*^9, 
   3.815835226688691*^9}, {3.815835324361313*^9, 3.815835367633274*^9}, 
   3.8159001014803276`*^9, {3.815904702947131*^9, 3.8159047298114023`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"ba6b174e-6069-49a4-9736-c6b82eff5042"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"1", ",", "1", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8158340237847395`*^9, 3.815834060408217*^9}, {
  3.8158345223850207`*^9, 3.8158345629286633`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"ad07cf26-0e3a-4efe-83b3-0378156ef30f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"461309480042", ",", "405870097633", ",", "2", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8158340622144146`*^9, {3.815834498553709*^9, 3.8158345642730427`*^9}, 
   3.815834711987054*^9, 3.815834822939886*^9, 3.815834863605383*^9, {
   3.8158349321827865`*^9, 3.8158349396908207`*^9}, 3.8158350432593126`*^9, {
   3.815835127166383*^9, 3.8158351353755026`*^9}, 3.8158352481644363`*^9, {
   3.8158353344738264`*^9, 3.8158353788923655`*^9}, 3.815835585113763*^9, 
   3.815899482421151*^9, 3.8159040779770737`*^9, 3.816325824813239*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"07ea94f7-23bb-4d44-8cf4-e4796c0db287"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd2", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815834579624029*^9, 3.815834600071784*^9}, {
  3.815834904817478*^9, 3.815834916792432*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"7398a67f-9ce7-4519-a0e8-08d7e970e8be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"181112483715", ",", "239016175650", ",", "3", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.81583458427559*^9, 3.815834600491662*^9}, 
   3.815834712084821*^9, 3.8158348229798126`*^9, 3.8158348636445436`*^9, {
   3.8158349322297707`*^9, 3.815834939745674*^9}, 3.8158350435285892`*^9, {
   3.8158351272112627`*^9, 3.8158351355320835`*^9}, 3.8158352482013645`*^9, {
   3.8158353345256824`*^9, 3.8158353789392753`*^9}, 3.8158355851806173`*^9, 
   3.81589948247558*^9, 3.8159040780638523`*^9, 3.816325824967823*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"5f5918d3-3dd8-493e-b720-daebeb303232"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd2", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815835056032199*^9, 3.8158350582492714`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"5d3c4970-e78d-47b3-bb64-ea4a99a2a6a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"249790497", ",", "2967604756", ",", "3", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8158350597363253`*^9, {3.815835127393775*^9, 3.815835135612898*^9}, 
   3.815835248257188*^9, {3.8158353346563396`*^9, 3.815835378985144*^9}, 
   3.8158355852125316`*^9, 3.815899482504537*^9, 3.8159040782493143`*^9, 
   3.816325824996713*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"cb2f1e6d-a7e9-4086-ad93-83c5130410e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd3", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"2", ",", "2", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815834744088831*^9, 3.8158347466878815`*^9}, {
  3.8158349088965445`*^9, 3.815834922112673*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"4481940d-1a11-4d28-acc2-28833e271760"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"17906591420", ",", "5223316926", ",", "4", ",", "4"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8158347480442867`*^9, 3.8158348230207043`*^9, 3.81583486376326*^9, {
   3.8158349322776375`*^9, 3.8158349397885547`*^9}, 3.8158350436452446`*^9, {
   3.8158351274376574`*^9, 3.815835135689663*^9}, 3.815835248295087*^9, {
   3.8158353346992283`*^9, 3.8158353790340157`*^9}, 3.815835585326231*^9, 
   3.8158994825424013`*^9, 3.815904078298184*^9, 3.816325825024674*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"1e84e027-0004-4bf9-8d66-e5ca57fb6992"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd4", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"5", ",", "5", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815834754911892*^9, 3.8158347575767884`*^9}, {
  3.815834926393198*^9, 3.8158349270245447`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"e29760b3-8256-45e8-b782-11cd3f03d0cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20171268197", ",", "33173111824", ",", "10", ",", "10"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.815834759051208*^9, 3.8158348230605965`*^9, 3.815834863918845*^9, {
   3.8158349323344903`*^9, 3.815834939859372*^9}, 3.8158350436941442`*^9, {
   3.8158351275233965`*^9, 3.8158351358572145`*^9}, 3.8158352483374615`*^9, {
   3.815835334742104*^9, 3.8158353791985807`*^9}, 3.815835585386036*^9, 
   3.8158994825743885`*^9, 3.81590407839095*^9, 3.8163258250625753`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"b5f2ac1c-ddc4-402f-955b-69ad6a8eeb18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pAdd5", " ", "=", " ", 
  RowBox[{"PaillierAddition", "[", 
   RowBox[{"7", ",", "3", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8158350795607815`*^9, 3.815835086856286*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"e1ef3829-fd71-401b-9688-b028e01a4c24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"91305224559", ",", "89009514862", ",", "10", ",", "10"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.815835088322363*^9, {3.8158351275663166`*^9, 3.8158351359001303`*^9}, 
   3.8158352483813486`*^9, {3.8158353347879825`*^9, 3.815835379312278*^9}, 
   3.815835585428953*^9, 3.815899482607292*^9, 3.8159040784218645`*^9, 
   3.816325825126399*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"01007ff5-e263-4b8f-919d-eb6c209ec1a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
  "MULTIPLICATION", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.815900215722431*^9, 3.8159002183292103`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"958381a6-728c-4d1a-a15e-a704090ba646"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaillierMultiplication", "[", 
   RowBox[{"message_", ",", "message2_", ",", " ", "primeSize_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "keySetup", ",", "g", ",", "r1", ",", "r2", ",", "n", ",", "n2", ",", 
      "ciphertext", ",", "ciphertext2", ",", " ", "gm", " ", ",", " ", "rn", 
      ",", " ", "gmrn", ",", " ", "output", ",", " ", "helper", ",", " ", 
      "helper2", ",", "r", ",", "test"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ciphertext", ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"keySetup", " ", "=", " ", 
      RowBox[{"KeyGen", "[", "primeSize", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "  ", "=", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "  ", "=", " ", 
      RowBox[{"keySetup", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n2", " ", "=", " ", 
      RowBox[{"n", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "  ", "=", 
      RowBox[{"RPicker", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2", "  ", "=", 
      RowBox[{"RPicker", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"message", "<", "n"}], " ", "&&", 
        RowBox[{"r1", " ", "<", "n"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"g", "^", "message"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rn", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"r1", "^", "n"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gmrn", " ", "=", " ", 
         RowBox[{"gm", " ", "*", " ", "rn"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ciphertext", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{"gmrn", ",", 
           RowBox[{"(", 
            RowBox[{"n", "^", "2"}], ")"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"message2", "<", "n"}], " ", "&&", 
        RowBox[{"r2", " ", "<", "n"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"g", "^", "message2"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rn", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"r2", "^", "n"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gmrn", " ", "=", " ", 
         RowBox[{"gm", " ", "*", " ", "rn"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ciphertext2", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{"gmrn", ",", 
           RowBox[{"(", 
            RowBox[{"n", "^", "2"}], ")"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"PaillierDecryption", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"PowerMod", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ciphertext", "^", "message2"}], ")"}], ",", "1", ",", 
           "n2"}], "]"}], ")"}], ",", 
        RowBox[{"keySetup", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "5"}], "]"}], "]"}], ",", "n", " ", ",", 
        RowBox[{"keySetup", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"test", " ", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"message", "*", "message2"}], ")"}], ",", " ", "n"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"helper", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ciphertext", ",", "ciphertext2", ",", "r", ",", "test"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", "helper"}], " ", ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.815835410928852*^9, 3.8158354149141674`*^9}, {
   3.815835493929882*^9, 3.8158355003320932`*^9}, {3.8158355727046323`*^9, 
   3.8158355753535213`*^9}, 3.815843086560893*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"9a95787d-ba40-4da7-890e-28a520a3d5d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pMultiplicate", " ", "=", " ", 
  RowBox[{"PaillierMultiplication", "[", 
   RowBox[{"2", ",", "2", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8158355141620746`*^9, 3.81583553897579*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d0d3dda4-1b4c-4528-968b-1d0d945c55a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"37583920646", ",", "42877734168", ",", "4", ",", "4"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.815835540056898*^9, 3.815835585581547*^9, 
  3.8158994827590833`*^9, 3.815904078488675*^9, 3.816325825195182*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"6320a8c4-f2fd-4034-ad21-bdbba651d1c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pMultiplicate2", "=", " ", 
  RowBox[{"PaillierMultiplication", "[", 
   RowBox[{"3", ",", "2", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8158355503443937`*^9, {3.815835590776769*^9, 3.815835593672987*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"69d99416-edbb-4da8-a154-6b6bb123aaba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"294707029860", ",", "81842615570", ",", "6", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8158355856574526`*^9, 3.8158355946035285`*^9}, 
   3.8158994827950273`*^9, 3.815904078530599*^9, 3.8163258253039274`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"f42aa061-5733-4d17-a7da-8ea6715dca21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pMultiplicate2", "=", " ", 
  RowBox[{"PaillierMultiplication", "[", 
   RowBox[{"3", ",", "10", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81583560143224*^9, 3.8158356016247473`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"882c9122-96a2-4531-ae5b-43f203ca4e75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5232284451", ",", "23842809435", ",", "30", ",", "30"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8158356022460966`*^9, 3.815899482891801*^9, 
  3.8159040785700507`*^9, 3.816325825343816*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"95c460c2-f0d8-4633-b69b-62a6ccf9cf40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pMultiplicate2", "=", " ", 
  RowBox[{"PaillierMultiplication", "[", 
   RowBox[{"30", ",", "35", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8158356100561805`*^9, 3.8158356155594645`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"bdb7a532-255c-496a-b789-80ca59460f7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"158712025434", ",", "5083767934", ",", "1050", ",", "1050"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.815835617557124*^9, 3.8158994829217205`*^9, 
  3.8159040786079755`*^9, 3.8163258254136305`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"e54d5986-bf35-4658-9057-b9a167303a6e"]
}, Open  ]]
},
WindowSize->{720., 740.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6d77ac9a-3a5e-4b49-b965-e7942e29e315"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 162, 3, 34, "Text",ExpressionUUID->"eea28e68-7768-4a31-bbf4-c08e92a80b9b"],
Cell[723, 25, 303, 4, 104, "Input",ExpressionUUID->"ea3a6ab2-9f5d-4817-b308-126de7cb915a"],
Cell[1029, 31, 5685, 133, 741, "Input",ExpressionUUID->"fbfbd107-912d-4eb6-8c4e-d1211e2f2e8c"],
Cell[6717, 166, 261, 4, 66, "Input",ExpressionUUID->"90aa47cf-12df-4a37-b189-ef5c94ceceb0"],
Cell[6981, 172, 1433, 36, 216, "Input",ExpressionUUID->"b54be936-7f26-45c0-b7ee-bd09a198d2bc"],
Cell[8417, 210, 304, 5, 66, "Input",ExpressionUUID->"3d609597-b799-4564-ad2d-25f4d751b974"],
Cell[8724, 217, 1121, 28, 235, "Input",ExpressionUUID->"26a629b4-929e-44d5-8e14-3872c306b23a"],
Cell[9848, 247, 253, 4, 66, "Input",ExpressionUUID->"84a8c9e1-eca3-4820-9c96-934a87dde6ed"],
Cell[10104, 253, 1789, 47, 312, "Input",ExpressionUUID->"5ccdb1c3-644e-47cd-8f3d-2fb5e5ffd8ab"],
Cell[11896, 302, 308, 4, 104, "Input",ExpressionUUID->"5432a34b-590e-4ee3-8a69-5f8a7cfd0cff"],
Cell[12207, 308, 3176, 70, 404, "Input",ExpressionUUID->"27eac983-7617-4010-b685-8d4c2f6f5cad"],
Cell[CellGroupData[{
Cell[15408, 382, 243, 4, 28, "Input",ExpressionUUID->"e0e75954-8193-4dc8-b9f1-2d7b1f8ce2e4"],
Cell[15654, 388, 2005, 32, 32, "Output",ExpressionUUID->"a189ef88-e452-45ab-bab7-34e9c4fbb8d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17696, 425, 225, 4, 28, "Input",ExpressionUUID->"4bd3ede7-38c8-4393-98ca-1b6fda06eb65"],
Cell[17924, 431, 1630, 25, 32, "Output",ExpressionUUID->"60604f8f-6cdd-4cd9-9229-0eb9bd32b106"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19591, 461, 326, 6, 28, "Input",ExpressionUUID->"5ef547c9-0f17-4b2d-856c-a2ded9fb4fe1"],
Cell[19920, 469, 1678, 24, 32, "Output",ExpressionUUID->"736801e3-49c2-412e-ac3b-f82208944568"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21635, 498, 200, 4, 28, "Input",ExpressionUUID->"ceaff396-b677-48b5-9d10-0d121f7f28e9"],
Cell[21838, 504, 1527, 22, 32, "Output",ExpressionUUID->"57e33d09-41ad-407f-b493-74587d3337aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23402, 531, 250, 5, 28, "Input",ExpressionUUID->"b502d9e3-afd8-4332-831b-3ef4c2b9b7e6"],
Cell[23655, 538, 1499, 21, 32, "Output",ExpressionUUID->"cbeca9d7-a365-44bd-9523-6bae99b94609"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25191, 564, 246, 6, 28, "Input",ExpressionUUID->"96670198-4699-4ae3-8f72-e1e647b1553d"],
Cell[25440, 572, 1493, 21, 32, "Output",ExpressionUUID->"8ec93cfc-d995-45fc-87c6-a1c5ea73bf51"]
}, Open  ]],
Cell[26948, 596, 199, 3, 28, "Input",ExpressionUUID->"f4502852-3673-4c55-9226-f3916131f618"],
Cell[CellGroupData[{
Cell[27172, 603, 439, 7, 28, "Input",ExpressionUUID->"f5f2faf7-42bc-4d46-b7f5-f927c9596d28"],
Cell[27614, 612, 1946, 31, 32, "Output",ExpressionUUID->"2ee56561-7876-4453-8b42-aed4e24d5ec6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29597, 648, 307, 4, 28, "Input",ExpressionUUID->"6d1aacd5-2fd2-426e-83a4-f9323e700c9d"],
Cell[29907, 654, 1735, 28, 32, "Output",ExpressionUUID->"90ae1892-9b9e-46d4-9e5d-d506775c4fd1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31679, 687, 583, 9, 28, "Input",ExpressionUUID->"2ebce9fd-efc1-43b9-bff3-9ddbe5c82bbc"],
Cell[32265, 698, 1546, 22, 32, "Output",ExpressionUUID->"e1617fcf-f7ce-4cf3-b6d3-523558bf313b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33848, 725, 283, 5, 28, "Input",ExpressionUUID->"f79aa4d0-43dc-4378-afc1-57e3126a1334"],
Cell[34134, 732, 1375, 21, 32, "Output",ExpressionUUID->"3d37ec45-7443-4d06-af86-66557af9facf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35546, 758, 355, 7, 28, "Input",ExpressionUUID->"210fe982-e9e2-4903-bb14-a8adefa0cf12"],
Cell[35904, 767, 1283, 18, 32, "Output",ExpressionUUID->"8bcf1e73-27db-44c9-81d2-8e465498fe55"]
}, Open  ]],
Cell[37202, 788, 307, 4, 104, "Input",ExpressionUUID->"3b62bda3-9f90-4f11-922c-2fb7842dd92d"],
Cell[37512, 794, 2047, 41, 235, "Input",ExpressionUUID->"5673865d-7d98-459d-8196-c21cacb7f3c9"],
Cell[CellGroupData[{
Cell[39584, 839, 346, 6, 28, "Input",ExpressionUUID->"c5712c7e-a685-4e33-a14d-277d9aa015de"],
Cell[39933, 847, 896, 13, 32, "Output",ExpressionUUID->"985a4b84-e31d-4468-b302-d9d60cf57119"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40866, 865, 500, 12, 28, "Input",ExpressionUUID->"5e27b5eb-dab1-4ac7-8eb0-faf68e75a1c0"],
Cell[41369, 879, 874, 12, 32, "Output",ExpressionUUID->"29e10655-6fd4-411c-9a52-fb729846a061"]
}, Open  ]],
Cell[42258, 894, 304, 4, 104, "Input",ExpressionUUID->"ec8498ec-212d-4000-8ac5-e8fe5a62fa13"],
Cell[42565, 900, 5593, 121, 722, "Input",ExpressionUUID->"ba6b174e-6069-49a4-9736-c6b82eff5042"],
Cell[CellGroupData[{
Cell[48183, 1025, 339, 6, 28, "Input",ExpressionUUID->"ad07cf26-0e3a-4efe-83b3-0378156ef30f"],
Cell[48525, 1033, 664, 11, 32, "Output",ExpressionUUID->"07ea94f7-23bb-4d44-8cf4-e4796c0db287"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49226, 1049, 334, 6, 28, "Input",ExpressionUUID->"7398a67f-9ce7-4519-a0e8-08d7e970e8be"],
Cell[49563, 1057, 639, 10, 32, "Output",ExpressionUUID->"5f5918d3-3dd8-493e-b720-daebeb303232"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50239, 1072, 287, 5, 28, "Input",ExpressionUUID->"5d3c4970-e78d-47b3-bb64-ea4a99a2a6a5"],
Cell[50529, 1079, 459, 9, 32, "Output",ExpressionUUID->"cb2f1e6d-a7e9-4086-ad93-83c5130410e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51025, 1093, 338, 6, 28, "Input",ExpressionUUID->"4481940d-1a11-4d28-acc2-28833e271760"],
Cell[51366, 1101, 586, 10, 32, "Output",ExpressionUUID->"1e84e027-0004-4bf9-8d66-e5ca57fb6992"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51989, 1116, 338, 6, 28, "Input",ExpressionUUID->"e29760b3-8256-45e8-b782-11cd3f03d0cf"],
Cell[52330, 1124, 589, 10, 32, "Output",ExpressionUUID->"b5f2ac1c-ddc4-402f-955b-69ad6a8eeb18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52956, 1139, 287, 5, 28, "Input",ExpressionUUID->"e1ef3829-fd71-401b-9688-b028e01a4c24"],
Cell[53246, 1146, 466, 9, 32, "Output",ExpressionUUID->"01007ff5-e263-4b8f-919d-eb6c209ec1a4"]
}, Open  ]],
Cell[53727, 1158, 315, 5, 104, "Input",ExpressionUUID->"958381a6-728c-4d1a-a15e-a704090ba646"],
Cell[54045, 1165, 4785, 110, 647, "Input",ExpressionUUID->"9a95787d-ba40-4da7-890e-28a520a3d5d2"],
Cell[CellGroupData[{
Cell[58855, 1279, 300, 5, 28, "Input",ExpressionUUID->"d0d3dda4-1b4c-4528-968b-1d0d945c55a5"],
Cell[59158, 1286, 330, 6, 32, "Output",ExpressionUUID->"6320a8c4-f2fd-4034-ad21-bdbba651d1c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59525, 1297, 322, 6, 28, "Input",ExpressionUUID->"69d99416-edbb-4da8-a154-6b6bb123aaba"],
Cell[59850, 1305, 340, 6, 32, "Output",ExpressionUUID->"f42aa061-5733-4d17-a7da-8ea6715dca21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60227, 1316, 297, 5, 28, "Input",ExpressionUUID->"882c9122-96a2-4531-ae5b-43f203ca4e75"],
Cell[60527, 1323, 311, 6, 32, "Output",ExpressionUUID->"95c460c2-f0d8-4633-b69b-62a6ccf9cf40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60875, 1334, 301, 5, 28, "Input",ExpressionUUID->"bdb7a532-255c-496a-b789-80ca59460f7c"],
Cell[61179, 1341, 318, 6, 32, "Output",ExpressionUUID->"e54d5986-bf35-4658-9057-b9a167303a6e"]
}, Open  ]]
}
]
*)

